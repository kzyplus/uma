<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>有馬記念2025 総合評価シート</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: #f8f9fa;
            color: #212529;
            line-height: 1.6;
            min-height: 100vh;
        }
        .glass-card {
            background: #fff;
            border-radius: 12px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08);
            border: 1px solid #e9ecef;
        }
        .horse-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .horse-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            border-color: #cbd5e1;
        }
        html { scroll-behavior: smooth; }
        .nav-index {
            position: fixed; top: 50%; right: 1rem; transform: translateY(-50%);
            z-index: 50; display: flex; flex-direction: column; gap: 0.5rem;
        }
        .nav-index a {
            display: flex; align-items: center; justify-content: center;
            width: 40px; height: 40px; background: #fff; border-radius: 50%;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1); color: #6366f1;
            font-size: 0.75rem; font-weight: bold; transition: all 0.2s;
            text-decoration: none; border: 1px solid #e9ecef;
        }
        .nav-index a:hover, .nav-index a.active {
            background: #6366f1; color: white; transform: scale(1.1); border-color: #6366f1;
        }
        .nav-tooltip {
            position: absolute; right: 50px; background: #1f2937; color: white;
            padding: 0.25rem 0.75rem; border-radius: 4px; font-size: 0.75rem;
            white-space: nowrap; opacity: 0; pointer-events: none; transition: opacity 0.2s;
        }
        .nav-index a:hover .nav-tooltip { opacity: 1; }
        #backToTop {
            position: fixed; bottom: 2rem; right: 1rem; width: 48px; height: 48px;
            background: #6366f1; color: white; border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3); cursor: pointer;
            opacity: 0; visibility: hidden; transition: all 0.3s; z-index: 50; border: none;
        }
        #backToTop.visible { opacity: 1; visibility: visible; }
        #backToTop:hover { background: #4f46e5; transform: translateY(-3px); }
        @media (max-width: 768px) {
            .nav-index { display: none; }
            .mobile-nav {
                position: fixed; bottom: 0; left: 0; right: 0; background: #fff;
                border-top: 1px solid #e9ecef; box-shadow: 0 -2px 10px rgba(0,0,0,0.05);
                z-index: 50; padding: 0.5rem; display: flex; overflow-x: auto; gap: 0.5rem;
            }
            .mobile-nav a {
                flex-shrink: 0; padding: 0.5rem 0.75rem; background: #f8f9fa;
                border: 1px solid #e9ecef; border-radius: 20px; font-size: 0.75rem;
                color: #495057; text-decoration: none; font-weight: 500;
            }
            .mobile-nav a.active { background: #6366f1; color: white; border-color: #6366f1; }
            body { padding-bottom: 60px; }
            #backToTop { bottom: 5rem; }
        }
        .badge-honmei {
            background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);
        }
        .badge-taikou {
            background: linear-gradient(135deg, #ea580c 0%, #c2410c 100%);
        }
        .badge-ana {
            background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
        }
        .badge-renka {
            background: linear-gradient(135deg, #16a34a 0%, #15803d 100%);
        }
        .badge-kiken {
            background: linear-gradient(135deg, #6b7280 0%, #4b5563 100%);
        }
        @media (max-width: 640px) {
            .responsive-text { font-size: 0.875rem; }
            #rankingChartContainer { height: 280px !important; }
        }
    </style>
</head>
<body class="p-4 md:p-8">
    <nav class="nav-index">
        <a href="../index.html" style="background: #6366f1; color: white; border-color: #6366f1;"><i class="fas fa-th-list"></i><span class="nav-tooltip">一覧へ戻る</span></a>
        <a href="#header"><i class="fas fa-home"></i><span class="nav-tooltip">トップ</span></a>
        <a href="#course"><i class="fas fa-map-marked-alt"></i><span class="nav-tooltip">コース</span></a>
        <a href="#conclusion"><i class="fas fa-trophy"></i><span class="nav-tooltip">結論</span></a>
        <a href="#ranking"><i class="fas fa-list-ol"></i><span class="nav-tooltip">ランキング</span></a>
        <a href="#horses"><i class="fas fa-horse"></i><span class="nav-tooltip">個別評価</span></a>
        <a href="#betting"><i class="fas fa-ticket-alt"></i><span class="nav-tooltip">買い目</span></a>
        <a href="#result"><i class="fas fa-flag-checkered"></i><span class="nav-tooltip">結果</span></a>
    </nav>
    <nav class="mobile-nav">
        <a href="../index.html" style="background: #6366f1; color: white; border-color: #6366f1;">← 一覧</a>
        <a href="#header">トップ</a>
        <a href="#course">コース</a>
        <a href="#conclusion">結論</a>
        <a href="#ranking">ランキング</a>
        <a href="#horses">個別評価</a>
        <a href="#betting">買い目</a>
        <a href="#result">結果</a>
    </nav>
    <button id="backToTop" onclick="window.scrollTo({top: 0, behavior: 'smooth'})"><i class="fas fa-chevron-up"></i></button>
    <div class="max-w-7xl mx-auto">
        <!-- ヘッダー -->
        <div id="header" class="glass-card p-6 md:p-8 mb-6">
            <h1 class="text-3xl md:text-4xl font-bold text-center mb-4 text-gray-800">
                第70回 有馬記念 2025
            </h1>
            <p class="text-center text-gray-600 mb-4">GI / 総合評価シート</p>

            <!-- 基本情報 -->
            <div class="grid grid-cols-2 md:grid-cols-5 gap-4 text-center">
                <div class="p-4 bg-green-50 rounded-lg border border-green-200">
                    <div class="text-sm text-gray-600">開催日</div>
                    <div class="font-bold text-gray-800">2025年12月28日（日）</div>
                </div>
                <div class="p-4 bg-green-50 rounded-lg border border-green-200">
                    <div class="text-sm text-gray-600">競馬場</div>
                    <div class="font-bold text-gray-800">中山競馬場</div>
                </div>
                <div class="p-4 bg-green-50 rounded-lg border border-green-200">
                    <div class="text-sm text-gray-600">コース</div>
                    <div class="font-bold text-gray-800">芝2500m（右）</div>
                </div>
                <div class="p-4 bg-blue-100 rounded-lg border border-blue-200">
                    <div class="text-sm text-gray-600">想定馬場</div>
                    <div class="font-bold text-blue-700">良</div>
                </div>
                <div class="p-4 bg-amber-50 rounded-lg border border-amber-200">
                    <div class="text-sm text-gray-600">1着賞金</div>
                    <div class="font-bold text-amber-700">5億円</div>
                </div>
            </div>
        </div>

        <!-- 中山芝2500mの特徴 -->
        <div id="course" class="glass-card p-6 md:p-8 mb-6 scroll-mt-4">
            <h2 class="text-2xl font-bold mb-6 text-gray-800 flex items-center">
                <i class="fas fa-map-marked-alt mr-2 text-indigo-500"></i>
                中山芝2500mの特徴
            </h2>
            <div class="grid md:grid-cols-2 gap-4">
                <div class="p-4 bg-slate-50 rounded-lg">
                    <div class="font-bold text-gray-800 mb-2">コース特性</div>
                    <ul class="text-sm text-gray-700 space-y-1">
                        <li>・<span class="font-bold">直線</span>: 310m（短い）</li>
                        <li>・<span class="font-bold">高低差</span>: 5.3m（急坂あり）</li>
                        <li>・<span class="font-bold">スタート</span>: 外回り4角付近</li>
                        <li>・<span class="font-bold">有利脚質</span>: 先行〜好位差し</li>
                    </ul>
                </div>
                <div class="p-4 bg-slate-50 rounded-lg">
                    <div class="font-bold text-gray-800 mb-2">求められる能力</div>
                    <ul class="text-sm text-gray-700 space-y-1">
                        <li>・パワー・スタミナ・器用さ</li>
                        <li>・<span class="font-bold text-red-600">直線短く追込不発リスク</span></li>
                        <li>・内枠有利の傾向</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- 最終結論 -->
        <div id="conclusion" class="glass-card p-6 md:p-8 mb-6 scroll-mt-4">
            <h2 class="text-2xl font-bold mb-6 text-gray-800 flex items-center">
                <i class="fas fa-trophy mr-2 text-amber-500"></i>
                最終結論
            </h2>

            <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
                <!-- 本命 -->
                <div class="border-2 border-red-400 rounded-lg p-4 bg-gradient-to-br from-red-50 to-pink-50">
                    <div class="badge-honmei text-white text-center py-1 px-3 rounded-full inline-block mb-3">
                        <i class="fas fa-star"></i> 本命
                    </div>
                    <div class="text-2xl font-bold text-gray-800 mb-2">
                        ◎ 9番 ダノンデサイル
                    </div>
                    <div class="text-lg font-bold text-red-600 mb-2">61点</div>
                    <div class="text-sm text-gray-700 space-y-1">
                        <div><i class="fas fa-check-circle text-green-600"></i> 騎手コミットメント+6点</div>
                        <div><i class="fas fa-check-circle text-green-600"></i> 中山【2.0.1.0】馬券外なし</div>
                        <div><i class="fas fa-check-circle text-green-600"></i> 追い切りA評価</div>
                    </div>
                </div>

                <!-- 対抗 -->
                <div class="border-2 border-orange-400 rounded-lg p-4 bg-gradient-to-br from-orange-50 to-amber-50">
                    <div class="badge-taikou text-white text-center py-1 px-3 rounded-full inline-block mb-3">
                        <i class="fas fa-medal"></i> 対抗
                    </div>
                    <div class="text-2xl font-bold text-gray-800 mb-2">
                        ○ 16番 タスティエーラ
                    </div>
                    <div class="text-lg font-bold text-orange-600 mb-2">50点</div>
                    <div class="text-sm text-gray-700 space-y-1">
                        <div><i class="fas fa-check-circle text-green-600"></i> ラストラン、仕上げ万全</div>
                        <div><i class="fas fa-check-circle text-green-600"></i> 追い切り美浦1番時計</div>
                        <div><i class="fas fa-exclamation-triangle text-amber-600"></i> 大外枠が不安</div>
                    </div>
                </div>

                <!-- 単穴 -->
                <div class="border-2 border-blue-400 rounded-lg p-4 bg-gradient-to-br from-blue-50 to-sky-50">
                    <div class="badge-ana text-white text-center py-1 px-3 rounded-full inline-block mb-3">
                        <i class="fas fa-gem"></i> 単穴
                    </div>
                    <div class="text-2xl font-bold text-gray-800 mb-2">
                        ▲ 3番 ジャスティンパレス
                    </div>
                    <div class="text-lg font-bold text-blue-600 mb-2">49点</div>
                    <div class="text-sm text-gray-700 space-y-1">
                        <div><i class="fas fa-check-circle text-green-600"></i> 復調傾向+2点</div>
                        <div><i class="fas fa-check-circle text-green-600"></i> 引退レース</div>
                        <div><i class="fas fa-check-circle text-green-600"></i> 好枠（2枠3番）</div>
                    </div>
                </div>

                <!-- 連下 -->
                <div class="border-2 border-green-400 rounded-lg p-4 bg-gradient-to-br from-green-50 to-emerald-50">
                    <div class="badge-renka text-white text-center py-1 px-3 rounded-full inline-block mb-3">
                        <i class="fas fa-horse"></i> 連下
                    </div>
                    <div class="text-2xl font-bold text-gray-800 mb-2">
                        △ 1番 エキサイトバイオ
                    </div>
                    <div class="text-lg font-bold text-green-600 mb-2">42点</div>
                    <div class="text-sm text-gray-700 space-y-1">
                        <div><i class="fas fa-check-circle text-green-600"></i> 前走G3勝ち+2点</div>
                        <div><i class="fas fa-check-circle text-green-600"></i> 最内枠（1枠1番）</div>
                        <div><i class="fas fa-check-circle text-green-600"></i> 菊花賞3着実績</div>
                    </div>
                </div>
            </div>

            <!-- 危険な人気馬 -->
            <div class="border-2 border-gray-400 rounded-lg p-4 bg-gradient-to-br from-gray-50 to-slate-100">
                <div class="badge-kiken text-white text-center py-1 px-3 rounded-full inline-block mb-3">
                    <i class="fas fa-exclamation-triangle"></i> 危険な人気馬
                </div>
                <div class="grid md:grid-cols-2 gap-4">
                    <div>
                        <div class="text-xl font-bold text-gray-800 mb-2">
                            × 4番 ミュージアムマイル
                        </div>
                        <div class="text-sm text-gray-700">
                            <span class="font-bold text-red-600">2500m未経験</span>（ベスト2000〜2200m）、ダービー6着
                        </div>
                    </div>
                    <div>
                        <div class="text-xl font-bold text-gray-800 mb-2">
                            × 2番 シンエンペラー
                        </div>
                        <div class="text-sm text-gray-700">
                            <span class="font-bold text-red-600">2025年【7着→6着→8着】</span>、矢作師「がくぜんとした」
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 総合評価ランキング（グラフ） -->
        <div class="glass-card p-6 md:p-8 mb-6">
            <h2 class="text-2xl font-bold mb-6 text-gray-800 flex items-center">
                <i class="fas fa-chart-bar mr-2 text-indigo-500"></i>
                総合評価ランキング
            </h2>

            <div id="rankingChartContainer" class="mb-8" style="height: 350px; position: relative;">
                <canvas id="rankingChart"></canvas>
            </div>

            <!-- テーブル -->
            <div class="overflow-x-auto">
                <table class="w-full text-sm">
                    <thead class="bg-green-800 text-white">
                        <tr>
                            <th class="p-3 text-left">順位</th>
                            <th class="p-3 text-left">印</th>
                            <th class="p-3 text-left">馬番</th>
                            <th class="p-3 text-left">馬名</th>
                            <th class="p-3 text-center">騎手</th>
                            <th class="p-3 text-center">基本</th>
                            <th class="p-3 text-center">補正</th>
                            <th class="p-3 text-center">最終</th>
                            <th class="p-3 text-center">良</th>
                            <th class="p-3 text-center">重</th>
                        </tr>
                    </thead>
                    <tbody id="rankingTable" class="divide-y divide-gray-200">
                    </tbody>
                </table>
            </div>
        </div>

        <!-- 個別馬評価 -->
        <div class="glass-card p-6 md:p-8 mb-6">
            <h2 class="text-2xl font-bold mb-6 text-gray-800 flex items-center">
                <i class="fas fa-horse mr-2 text-indigo-500"></i>
                個別馬評価（12項目レーダーチャート）
            </h2>

            <div class="flex flex-wrap gap-2 mb-6">
                <button onclick="filterHorses('all')" class="filter-btn bg-green-700 text-white px-4 py-2 rounded-lg hover:bg-green-800 transition">
                    全て表示
                </button>
                <button onclick="filterHorses('top')" class="filter-btn bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition">
                    上位馬のみ
                </button>
                <button onclick="filterHorses('ana')" class="filter-btn bg-amber-600 text-white px-4 py-2 rounded-lg hover:bg-amber-700 transition">
                    注目馬
                </button>
            </div>

            <div id="horseCards" class="space-y-4">
            </div>
        </div>

        <!-- 展開予測 -->
        <div class="glass-card p-6 md:p-8 mb-6">
            <h2 class="text-2xl font-bold mb-6 text-gray-800 flex items-center">
                <i class="fas fa-running mr-2 text-indigo-500"></i>
                展開予測
            </h2>

            <div class="grid md:grid-cols-2 gap-6">
                <div>
                    <h3 class="font-bold text-lg mb-4 text-gray-700">ペース・脚質分析</h3>
                    <div class="space-y-3">
                        <div class="p-4 bg-blue-100 rounded-lg">
                            <div class="font-bold text-gray-800">ペース予想</div>
                            <div class="text-gray-700">ミドル〜ややスロー</div>
                        </div>
                        <div class="p-4 bg-green-100 rounded-lg">
                            <div class="font-bold text-gray-800">有利脚質</div>
                            <div class="text-gray-700">先行〜好位差し</div>
                        </div>
                        <div class="p-4 bg-purple-100 rounded-lg">
                            <div class="font-bold text-gray-800">展開の鍵</div>
                            <div class="text-gray-700">メイショウタバル（武豊）の逃げ</div>
                        </div>
                    </div>
                </div>

                <div>
                    <h3 class="font-bold text-lg mb-4 text-gray-700">隊列イメージ</h3>
                    <div class="space-y-3">
                        <div class="p-3 bg-red-100 rounded-lg border-l-4 border-red-500">
                            <span class="font-bold text-red-700">逃げ：</span>
                            <span class="text-gray-700">メイショウタバル（単騎濃厚）</span>
                        </div>
                        <div class="p-3 bg-yellow-100 rounded-lg border-l-4 border-yellow-500">
                            <span class="font-bold text-yellow-700">先行：</span>
                            <span class="text-gray-700">エキサイトバイオ、コスモキュランダ</span>
                        </div>
                        <div class="p-3 bg-blue-100 rounded-lg border-l-4 border-blue-500">
                            <span class="font-bold text-blue-700">好位：</span>
                            <span class="text-gray-700">ダノンデサイル、ミュージアムマイル</span>
                        </div>
                        <div class="p-3 bg-green-100 rounded-lg border-l-4 border-green-500">
                            <span class="font-bold text-indigo-500">差し：</span>
                            <span class="text-gray-700">レガレイラ、ジャスティンパレス</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 買い目参考 -->
        <div class="glass-card p-6 md:p-8 mb-6">
            <h2 class="text-2xl font-bold mb-6 text-gray-800 flex items-center">
                <i class="fas fa-ticket-alt mr-2 text-indigo-500"></i>
                買い目参考
            </h2>

            <div class="grid md:grid-cols-3 gap-4">
                <div class="p-4 bg-gradient-to-r from-red-50 to-pink-50 rounded-lg border border-red-200">
                    <div class="font-bold text-gray-800 mb-2">単勝</div>
                    <div class="text-2xl font-bold text-red-600">9</div>
                </div>
                <div class="p-4 bg-gradient-to-r from-green-50 to-emerald-50 rounded-lg border border-green-200">
                    <div class="font-bold text-gray-800 mb-2">複勝</div>
                    <div class="text-xl font-bold text-green-600">9・10</div>
                    <div class="text-sm text-gray-600 mt-1">ダノンデサイル・コスモキュランダ</div>
                </div>
                <div class="p-4 bg-gradient-to-r from-blue-50 to-sky-50 rounded-lg border border-blue-200">
                    <div class="font-bold text-gray-800 mb-2">馬連</div>
                    <div class="text-xl font-bold text-blue-600">9-16・9-3・9-5</div>
                </div>
                <div class="p-4 bg-gradient-to-r from-amber-50 to-yellow-50 rounded-lg border border-amber-200">
                    <div class="font-bold text-gray-800 mb-2">ワイド</div>
                    <div class="text-xl font-bold text-amber-600">9-3・9-10・9-1</div>
                </div>
                <div class="p-4 bg-gradient-to-r from-indigo-50 to-purple-50 rounded-lg border border-indigo-200">
                    <div class="font-bold text-gray-800 mb-2">三連複</div>
                    <div class="text-lg font-bold text-indigo-600">9-16-3・9-16-10・9-3-10</div>
                </div>
                <div class="p-4 bg-gradient-to-r from-slate-50 to-gray-100 rounded-lg border border-slate-300">
                    <div class="font-bold text-gray-800 mb-2">三連単</div>
                    <div class="text-lg font-bold text-slate-700">9→16→3・9→3→16・9→10→3</div>
                </div>
            </div>
        </div>

        <!-- 適用ルール -->
        <div class="glass-card p-6 md:p-8 mb-6">
            <h2 class="text-2xl font-bold mb-6 text-gray-800 flex items-center">
                <i class="fas fa-cogs mr-2 text-indigo-500"></i>
                適用ルール一覧
            </h2>

            <div class="overflow-x-auto">
                <table class="w-full text-sm">
                    <thead class="bg-slate-600 text-white">
                        <tr>
                            <th class="p-3 text-left">ルール名</th>
                            <th class="p-3 text-left">対象馬</th>
                            <th class="p-3 text-center">補正</th>
                            <th class="p-3 text-left">根拠</th>
                        </tr>
                    </thead>
                    <tbody class="divide-y divide-gray-200">
                        <tr class="bg-red-50">
                            <td class="p-3 font-bold">騎手コミットメント</td>
                            <td class="p-3">ダノンデサイル</td>
                            <td class="p-3 text-center text-green-600 font-bold">+6点</td>
                            <td class="p-3">戸崎がレガレイラを蹴って選択</td>
                        </tr>
                        <tr>
                            <td class="p-3 font-bold">蹴られた馬の減点</td>
                            <td class="p-3">レガレイラ</td>
                            <td class="p-3 text-center text-red-600 font-bold">-2点</td>
                            <td class="p-3">主戦騎手に蹴られた</td>
                        </tr>
                        <tr class="bg-blue-50">
                            <td class="p-3 font-bold">復調傾向の評価</td>
                            <td class="p-3">ジャスティンパレス</td>
                            <td class="p-3 text-center text-green-600 font-bold">+2点</td>
                            <td class="p-3">2走連続人気以上の好走</td>
                        </tr>
                        <tr>
                            <td class="p-3 font-bold">前走重賞勝ち馬</td>
                            <td class="p-3">エキサイトバイオ</td>
                            <td class="p-3 text-center text-green-600 font-bold">+2点</td>
                            <td class="p-3">ラジオNIKKEI賞（G3）勝利</td>
                        </tr>
                        <tr class="bg-green-50">
                            <td class="p-3 font-bold">追い切りA評価</td>
                            <td class="p-3">ダノンデサイル、ミュージアムマイル他</td>
                            <td class="p-3 text-center text-green-600 font-bold">+3点</td>
                            <td class="p-3">調教診断A評価</td>
                        </tr>
                        <tr>
                            <td class="p-3 font-bold">厩舎別（一杯主体で遅い）</td>
                            <td class="p-3">シンエンペラー</td>
                            <td class="p-3 text-center text-red-600 font-bold">-1点</td>
                            <td class="p-3">矢作厩舎で想定より2秒遅い</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- 注意事項 -->
        <div class="glass-card p-6 md:p-8 mb-6">
            <h2 class="text-2xl font-bold mb-4 text-gray-800 flex items-center">
                <i class="fas fa-info-circle mr-2 text-blue-500"></i>
                備考・注意事項
            </h2>

            <div class="space-y-3 text-gray-700">
                <div class="p-4 bg-yellow-50 border-l-4 border-yellow-500 rounded">
                    <div class="font-bold mb-1">馬場が稍重〜重の場合</div>
                    <div>レガレイラを◎に格上げ検討（道悪得意）</div>
                </div>
                <div class="p-4 bg-blue-50 border-l-4 border-blue-500 rounded">
                    <div class="font-bold mb-1">パドック確認ポイント</div>
                    <div>・ダノンデサイル：馬体重（さらに減っていたら要注意）<br>・タスティエーラ：大外枠からのスタート対応</div>
                </div>
                <div class="p-4 bg-red-50 border-l-4 border-red-500 rounded">
                    <div class="font-bold mb-1">騎手コミットメント重視</div>
                    <div>戸崎騎手の選択を最重視。「ドバイでの走りが忘れられない」発言は本気の証。</div>
                </div>
            </div>
        </div>

        <!-- レース結果・振り返り -->
        <div id="result" class="glass-card p-6 md:p-8 mb-6">
            <h2 class="text-xl md:text-2xl font-bold text-gray-800 mb-6 flex items-center">
                <i class="fas fa-flag-checkered text-indigo-500 mr-3"></i>レース結果・振り返り
            </h2>

            <!-- 確定着順 -->
            <div class="mb-6">
                <h3 class="font-bold text-gray-700 mb-3"><i class="fas fa-medal mr-2 text-amber-500"></i>確定着順</h3>
                <div class="overflow-x-auto">
                    <table class="w-full text-sm">
                        <thead>
                            <tr class="bg-gray-100">
                                <th class="px-3 py-2 text-left">着順</th>
                                <th class="px-3 py-2 text-left">馬番</th>
                                <th class="px-3 py-2 text-left">馬名</th>
                                <th class="px-3 py-2 text-left">人気</th>
                                <th class="px-3 py-2 text-left">騎手</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="border-b bg-amber-50">
                                <td class="px-3 py-2 font-bold text-amber-600">1着</td>
                                <td class="px-3 py-2">4</td>
                                <td class="px-3 py-2 font-bold">ミュージアムマイル</td>
                                <td class="px-3 py-2">3番人気</td>
                                <td class="px-3 py-2">C.デムーロ</td>
                            </tr>
                            <tr class="border-b bg-gray-50">
                                <td class="px-3 py-2 font-bold text-gray-600">2着</td>
                                <td class="px-3 py-2">10</td>
                                <td class="px-3 py-2 font-bold">コスモキュランダ</td>
                                <td class="px-3 py-2">12番人気</td>
                                <td class="px-3 py-2">横山武史</td>
                            </tr>
                            <tr class="border-b">
                                <td class="px-3 py-2 font-bold text-orange-600">3着</td>
                                <td class="px-3 py-2">9</td>
                                <td class="px-3 py-2 font-bold">ダノンデサイル</td>
                                <td class="px-3 py-2">2番人気</td>
                                <td class="px-3 py-2">戸崎圭太</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="mt-3 p-3 bg-gray-50 rounded-lg text-sm">
                    <p><strong>勝ちタイム:</strong> 2分31秒5（良）</p>
                </div>
            </div>

            <!-- 予想との比較 -->
            <div class="mb-6">
                <h3 class="font-bold text-gray-700 mb-3"><i class="fas fa-balance-scale mr-2 text-indigo-500"></i>予想との比較</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="p-4 bg-indigo-50 rounded-lg border border-indigo-200">
                        <div class="font-bold text-indigo-700 mb-2">AI予想</div>
                        <div class="text-sm space-y-1">
                            <p>◎ 9番 ダノンデサイル → <span class="text-green-600 font-bold">3着</span></p>
                            <p>○ 16番 タスティエーラ → <span class="text-red-500 font-bold">着外</span></p>
                            <p>▲ 3番 ジャスティンパレス → <span class="text-red-500 font-bold">着外</span></p>
                            <p>× 4番 ミュージアムマイル → <span class="text-amber-500 font-bold">1着（危険馬が優勝）</span></p>
                        </div>
                    </div>
                    <div class="p-4 bg-gray-50 rounded-lg border border-gray-200">
                        <div class="font-bold text-gray-700 mb-2">実際の結果</div>
                        <div class="text-sm space-y-1">
                            <p>1着: 4番 ミュージアムマイル（3番人気）</p>
                            <p>2着: 10番 コスモキュランダ（12番人気）</p>
                            <p>3着: 9番 ダノンデサイル（2番人気・◎）</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 的中判定 -->
            <div class="mb-6">
                <h3 class="font-bold text-gray-700 mb-3"><i class="fas fa-check-circle mr-2 text-green-500"></i>的中判定</h3>
                <div class="p-4 bg-amber-50 rounded-lg border border-amber-200">
                    <div class="flex items-center mb-2">
                        <span class="text-2xl font-bold text-amber-600 mr-2">一部的中</span>
                        <span class="px-2 py-1 bg-amber-100 text-amber-700 rounded text-xs">本命3着</span>
                    </div>
                    <p class="text-sm text-gray-600">◎ダノンデサイルが3着。ワイド・複勝圏内には入ったが、勝ち馬は「×危険馬」に指定したミュージアムマイルだった。</p>
                </div>
            </div>

            <!-- 振り返り -->
            <div>
                <h3 class="font-bold text-gray-700 mb-3"><i class="fas fa-lightbulb mr-2 text-amber-500"></i>振り返り・反省点</h3>
                <div class="p-4 bg-amber-50 rounded-lg border border-amber-200 text-sm space-y-2">
                    <p><strong>1. 危険馬判定の失敗:</strong> ミュージアムマイルを「距離2500m不安」で×評価としたが、皐月賞馬の中山適性を過小評価。デムーロ騎手の有馬記念でのリベンジ意識も読み切れなかった。</p>
                    <p><strong>2. 騎手コミットメントへの過信:</strong> 戸崎騎手の「ドバイでの走りが忘れられない」発言を重視しすぎた。結果的にダノンデサイルは2年連続3着という惜しい結果に。</p>
                    <p><strong>3. 穴馬コスモキュランダの見落とし:</strong> 12番人気ながら2着。横山武史騎手の積極騎乗が奏功。人気薄の騎手の意欲も考慮すべきだった。</p>
                    <p><strong>4. 今後の教訓:</strong> 「距離不安」だけで危険馬判定するのは危険。コース実績（中山巧者）と騎手のモチベーションを総合評価すべき。</p>
                </div>
            </div>
        </div>

        <!-- フッター -->
        <div class="glass-card p-6 text-center text-sm">
            <p class="text-gray-600">作成日：2025年12月27日</p>
            <p class="mt-2 text-gray-500">分析指示書.md（騎手コミットメント評価含む最新版）適用</p>
            <p class="mt-3 text-xs text-gray-400"><i class="fas fa-exclamation-triangle mr-1"></i>予想は参考情報です。馬券購入は自己責任でお願いします。</p>
        </div>
    </div>

    <script>
        // 馬データ
        const horses = [
            {
                number: 1, name: "エキサイトバイオ", score: 42, baseScore: 40, adjustment: 2,
                good: "▲", heavy: "○", comment: "前走G3勝ち+2点、最内枠",
                jockey: "荻野極", trainer: "清水久詞厩舎（栗東）",
                blood: "父バゴ × 母父ハーツクライ", weight: "56kg",
                badge: "renka",
                details: {
                    pros: ["菊花賞3着（13番人気激走）", "前走ラジオNIKKEI賞勝利", "1枠1番の最内枠"],
                    cons: ["騎手の荻野極はG1実績乏しい", "古馬G1は初挑戦"],
                    expect: ["人気薄なら妙味大"],
                    scores: [4, 4, 4, 3, 3, 3, 3, 5, 2, 3, 3, 3]
                }
            },
            {
                number: 2, name: "シンエンペラー", score: 41, baseScore: 42, adjustment: -1,
                good: "△", heavy: "▲", comment: "2025年不振、追い切りに師不満",
                jockey: "坂井瑠星", trainer: "矢作芳人厩舎（栗東）",
                blood: "父Siyouni × 母父Galileo", weight: "58kg",
                badge: "kiken",
                details: {
                    pros: ["1枠2番の好枠", "凱旋門賞4着の世界実績"],
                    cons: ["2025年成績【7着→6着→8着】下降傾向", "矢作師「がくぜんとした」", "追い切り時計が想定より2秒遅い"],
                    expect: ["好枠を生かせれば一発あり"],
                    scores: [4, 5, 4, 3, 3, 3, 3, 5, 4, 2, 3, 3]
                }
            },
            {
                number: 3, name: "ジャスティンパレス", score: 49, baseScore: 47, adjustment: 2,
                good: "○", heavy: "○", comment: "復調傾向+2点、引退レース",
                jockey: "団野大成", trainer: "杉山晴紀厩舎（栗東）",
                blood: "父ディープインパクト × 母父Royal Anthem", weight: "58kg",
                badge: "ana",
                details: {
                    pros: ["復調傾向が顕著（2走連続人気以上の好走）", "天皇賞春G1勝ち馬", "引退レースで陣営の仕上げ期待", "好枠（2枠3番）"],
                    cons: ["団野騎手は初騎乗", "6歳で衰えの懸念"],
                    expect: ["復調傾向+引退レースの仕上げで激走期待"],
                    scores: [5, 5, 5, 4, 4, 3, 4, 4, 3, 3, 3, 4]
                }
            },
            {
                number: 4, name: "ミュージアムマイル", score: 48, baseScore: 48, adjustment: 0,
                good: "○", heavy: "▲", comment: "距離2500m不安",
                jockey: "C.デムーロ", trainer: "高柳大輔厩舎（美浦）",
                blood: "父リオンディーズ × 母父ハーツクライ", weight: "56kg",
                badge: "kiken",
                details: {
                    pros: ["中山【3.0.0.0】完璧な相性", "皐月賞馬、天皇賞秋2着", "追い切りA評価", "好枠（2枠4番）"],
                    cons: ["2500mは未経験（ベスト2000〜2200m）", "ダービー（2400m）では6着", "菊花賞2着も勝ち馬に0.4秒差"],
                    expect: ["中山適性は抜群、距離をこなせれば"],
                    scores: [5, 5, 3, 5, 4, 3, 4, 4, 4, 5, 3, 3]
                }
            },
            {
                number: 5, name: "レガレイラ", score: 47, baseScore: 49, adjustment: -2,
                good: "○", heavy: "◎", comment: "昨年覇者だが戸崎に蹴られた",
                jockey: "C.ルメール", trainer: "木村哲也厩舎（美浦）",
                blood: "父スワーヴリチャード × 母父ハービンジャー", weight: "56kg",
                badge: null,
                details: {
                    pros: ["昨年の有馬記念優勝馬", "中山G1・2勝の圧倒的コース適性", "ルメール騎乗で信頼度", "エリザベス女王杯勝利で復活"],
                    cons: ["主戦騎手の戸崎がダノンデサイルを選択（蹴られた）", "牝馬連覇は史上初の偉業で重圧"],
                    expect: ["道悪になれば評価UP"],
                    scores: [5, 5, 4, 5, 4, 4, 4, 4, 4, 3, 3, 4]
                }
            },
            {
                number: 6, name: "メイショウタバル", score: 46, baseScore: 46, adjustment: 0,
                good: "○", heavy: "○", comment: "武豊の逃げ、単騎濃厚",
                jockey: "武豊", trainer: "石橋守厩舎（栗東）",
                blood: "父ゴールドシップ × 母父フレンチデピュティ", weight: "58kg",
                badge: null,
                details: {
                    pros: ["武豊騎乗で逃げのペース配分は完璧", "父ゴールドシップの有馬記念父仔制覇の可能性", "単騎逃げが濃厚"],
                    cons: ["追い切りで行きたがる面", "馬体重+12kg予定でやや重い", "中山初出走"],
                    expect: ["武豊マジックで逃げ粘り"],
                    scores: [4, 4, 5, 3, 4, 3, 5, 4, 5, 3, 3, 3]
                }
            },
            {
                number: 7, name: "サンライズジパング", score: 30, baseScore: 32, adjustment: -2,
                good: "×", heavy: "△", comment: "ダート馬、芝G1は厳しい",
                jockey: "鮫島克駿", trainer: "音無秀孝厩舎（栗東）",
                blood: "父キズナ × 母父Street Cry", weight: "58kg",
                badge: null,
                details: {
                    pros: ["ダートG1級の能力"],
                    cons: ["ダート馬が芝G1に挑戦は無謀", "追い切りC評価", "中2週で間隔詰まる"],
                    expect: [],
                    scores: [3, 3, 3, 2, 3, 2, 3, 3, 3, 2, 2, 3]
                }
            },
            {
                number: 8, name: "シュヴァリエローズ", score: 37, baseScore: 37, adjustment: 0,
                good: "△", heavy: "△", comment: "G1では力不足",
                jockey: "北村友一", trainer: "池添学厩舎（栗東）",
                blood: "父キズナ × 母父ディープインパクト", weight: "58kg",
                badge: null,
                details: {
                    pros: ["血統的には距離OK"],
                    cons: ["G1では力不足", "7歳で上積みなし"],
                    expect: [],
                    scores: [3, 3, 4, 3, 3, 3, 3, 3, 3, 3, 3, 3]
                }
            },
            {
                number: 9, name: "ダノンデサイル", score: 61, baseScore: 52, adjustment: 9,
                good: "◎", heavy: "○", comment: "騎手コミットメント+6点が決め手",
                jockey: "戸崎圭太", trainer: "安田翔伍厩舎（栗東）",
                blood: "父エピファネイア × 母父Congrats", weight: "58kg",
                badge: "honmei",
                details: {
                    pros: ["戸崎騎手がレガレイラを蹴ってこちらを選択", "「ドバイでの走りが忘れられない」「かなりの能力を持ってる」", "ダービー馬＋ドバイシーマC優勝の世界実績", "中山【2.0.1.0】馬券外なし", "追い切りA評価、精神面安定"],
                    cons: ["馬体重減少傾向（520kg→508kg）", "JC入線後のアクシデント（精神面の影響不明）"],
                    expect: ["騎手の強い信頼がある馬は走る"],
                    scores: [5, 5, 4, 5, 4, 4, 4, 4, 5, 5, 3, 4]
                }
            },
            {
                number: 10, name: "コスモキュランダ", score: 46, baseScore: 46, adjustment: 0,
                good: "○", heavy: "○", comment: "皐月賞馬、陣営強気",
                jockey: "横山武史", trainer: "加藤士津八厩舎（美浦）",
                blood: "父アルアイン × 母父ケイムホーム", weight: "58kg",
                badge: null,
                details: {
                    pros: ["皐月賞馬、中山適性◎", "陣営「状態かなりいい」「この秋最高」", "ブリンカー装着で集中力UP"],
                    cons: ["この秋4戦目で疲労懸念", "菊花賞4着で長距離は微妙"],
                    expect: ["展開次第で好走可能"],
                    scores: [4, 4, 4, 5, 4, 3, 4, 3, 4, 4, 3, 4]
                }
            },
            {
                number: 11, name: "ミステリーウェイ", score: 35, baseScore: 35, adjustment: 0,
                good: "△", heavy: "△", comment: "G1では力不足",
                jockey: "松本大輝", trainer: "西村真幸厩舎（栗東）",
                blood: "父ハーツクライ × 母父Unbridled's Song", weight: "58kg",
                badge: null,
                details: {
                    pros: ["血統的には距離OK"],
                    cons: ["G1では力不足", "騎手もG1実績乏しい"],
                    expect: [],
                    scores: [3, 2, 4, 3, 3, 3, 3, 3, 2, 3, 3, 3]
                }
            },
            {
                number: 12, name: "マイネルエンペラー", score: 42, baseScore: 39, adjustment: 3,
                good: "▲", heavy: "▲", comment: "追い切りトップ評価だが休み明け",
                jockey: "丹内祐次", trainer: "宮田敬介厩舎（美浦）",
                blood: "父シュヴァルグラン × 母父ジャングルポケット", weight: "58kg",
                badge: null,
                details: {
                    pros: ["追い切りA評価でトップ評価", "「のびやかなフォームでグイグイ前に進む」"],
                    cons: ["8か月ぶりの休み明け", "G1では実績不足", "騎手の丹内はG1実績乏しい"],
                    expect: ["追い切り絶好なら穴で一考"],
                    scores: [3, 3, 4, 3, 4, 2, 3, 3, 3, 5, 3, 3]
                }
            },
            {
                number: 13, name: "アドマイヤテラ", score: 36, baseScore: 37, adjustment: -1,
                good: "△", heavy: "△", comment: "JC落馬から復帰",
                jockey: "川田将雅", trainer: "友道康夫厩舎（栗東）",
                blood: "父レイデオロ × 母父ハーツクライ", weight: "58kg",
                badge: null,
                details: {
                    pros: ["川田騎乗で信頼度", "友道厩舎は馬なり主体で時計出にくいタイプ"],
                    cons: ["JC落馬競走中止からの復帰", "追い切りで遅れ"],
                    expect: [],
                    scores: [3, 3, 4, 3, 3, 2, 3, 3, 4, 2, 3, 4]
                }
            },
            {
                number: 14, name: "アラタ", score: 30, baseScore: 32, adjustment: -2,
                good: "×", heavy: "△", comment: "8歳、力不足",
                jockey: "大野拓弥", trainer: "上原博之厩舎（美浦）",
                blood: "父キングカメハメハ × 母父サンデーサイレンス", weight: "58kg",
                badge: null,
                details: {
                    pros: ["中山実績あり"],
                    cons: ["8歳で衰え", "G1では力不足", "追い切りC評価"],
                    expect: [],
                    scores: [2, 2, 3, 3, 3, 3, 3, 2, 3, 2, 3, 3]
                }
            },
            {
                number: 15, name: "エルトンバローズ", score: 34, baseScore: 34, adjustment: 0,
                good: "△", heavy: "×", comment: "マイラー、距離長い",
                jockey: "西村淳也", trainer: "杉山晴紀厩舎（栗東）",
                blood: "父ディープブリランテ × 母父シンボリクリスエス", weight: "58kg",
                badge: null,
                details: {
                    pros: ["マイル路線では実力者"],
                    cons: ["マイラーが2500mは距離長すぎ", "大外枠不利", "調教軽めで本気度不明"],
                    expect: [],
                    scores: [3, 3, 3, 3, 3, 3, 2, 2, 3, 3, 3, 3]
                }
            },
            {
                number: 16, name: "タスティエーラ", score: 50, baseScore: 47, adjustment: 3,
                good: "○", heavy: "○", comment: "ラストラン、追い切り絶好",
                jockey: "松山弘平", trainer: "堀宣行厩舎（美浦）",
                blood: "父サトノクラウン × 母父マンハッタンカフェ", weight: "58kg",
                badge: "taikou",
                details: {
                    pros: ["ラストランで陣営の仕上げ万全", "追い切りA評価、美浦1番時計", "ダービー馬、有馬記念2着の実績", "堀厩舎は仕上げ上手"],
                    cons: ["8枠16番の大外枠", "JCから中3週で間隔詰まる"],
                    expect: ["ラストランの仕上げで激走期待"],
                    scores: [4, 5, 4, 4, 4, 3, 4, 2, 4, 5, 4, 4]
                }
            }
        ];

        // ランキングデータ
        const rankingData = [
            { rank: 1, number: 9, name: "ダノンデサイル", baseScore: 52, adjustment: "+9", score: 61, good: "◎", heavy: "○", mark: "◎", jockey: "戸崎圭太" },
            { rank: 2, number: 16, name: "タスティエーラ", baseScore: 47, adjustment: "+3", score: 50, good: "○", heavy: "○", mark: "○", jockey: "松山弘平" },
            { rank: 3, number: 3, name: "ジャスティンパレス", baseScore: 47, adjustment: "+2", score: 49, good: "○", heavy: "○", mark: "▲", jockey: "団野大成" },
            { rank: 4, number: 4, name: "ミュージアムマイル", baseScore: 48, adjustment: "±0", score: 48, good: "○", heavy: "▲", mark: "×", jockey: "C.デムーロ" },
            { rank: 5, number: 5, name: "レガレイラ", baseScore: 49, adjustment: "-2", score: 47, good: "○", heavy: "◎", mark: "", jockey: "C.ルメール" },
            { rank: 6, number: 6, name: "メイショウタバル", baseScore: 46, adjustment: "±0", score: 46, good: "○", heavy: "○", mark: "", jockey: "武豊" },
            { rank: 7, number: 10, name: "コスモキュランダ", baseScore: 46, adjustment: "±0", score: 46, good: "○", heavy: "○", mark: "", jockey: "横山武史" },
            { rank: 8, number: 1, name: "エキサイトバイオ", baseScore: 40, adjustment: "+2", score: 42, good: "▲", heavy: "○", mark: "△", jockey: "荻野極" },
            { rank: 9, number: 12, name: "マイネルエンペラー", baseScore: 39, adjustment: "+3", score: 42, good: "▲", heavy: "▲", mark: "", jockey: "丹内祐次" },
            { rank: 10, number: 2, name: "シンエンペラー", baseScore: 42, adjustment: "-1", score: 41, good: "△", heavy: "▲", mark: "×", jockey: "坂井瑠星" },
            { rank: 11, number: 8, name: "シュヴァリエローズ", baseScore: 37, adjustment: "±0", score: 37, good: "△", heavy: "△", mark: "", jockey: "北村友一" },
            { rank: 12, number: 13, name: "アドマイヤテラ", baseScore: 37, adjustment: "-1", score: 36, good: "△", heavy: "△", mark: "", jockey: "川田将雅" },
            { rank: 13, number: 11, name: "ミステリーウェイ", baseScore: 35, adjustment: "±0", score: 35, good: "△", heavy: "△", mark: "", jockey: "松本大輝" },
            { rank: 14, number: 15, name: "エルトンバローズ", baseScore: 34, adjustment: "±0", score: 34, good: "△", heavy: "×", mark: "", jockey: "西村淳也" },
            { rank: 15, number: 7, name: "サンライズジパング", baseScore: 32, adjustment: "-2", score: 30, good: "×", heavy: "△", mark: "", jockey: "鮫島克駿" },
            { rank: 16, number: 14, name: "アラタ", baseScore: 32, adjustment: "-2", score: 30, good: "×", heavy: "△", mark: "", jockey: "大野拓弥" }
        ];

        const evaluationItems = ["着差重視", "Lv", "血統", "コース", "輸送", "休明", "展開", "枠順", "騎手", "調教", "馬体", "厩舎"];

        document.addEventListener('DOMContentLoaded', function() {
            initRankingChart();
            renderRankingTable();
            renderHorseCards();
        });

        function initRankingChart() {
            const ctx = document.getElementById('rankingChart').getContext('2d');
            const topHorses = rankingData.slice(0, 10);
            const labels = topHorses.map(h => `${h.number}番 ${h.name}`);
            const scores = topHorses.map(h => h.score);

            const gradientColors = scores.map((score, index) => {
                if (index === 0) return 'rgba(220, 38, 38, 0.85)';
                if (index === 1) return 'rgba(234, 88, 12, 0.85)';
                if (index === 2) return 'rgba(37, 99, 235, 0.85)';
                if (index === 3) return 'rgba(107, 114, 128, 0.85)';
                return 'rgba(34, 197, 94, 0.7)';
            });

            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: '総合評価点',
                        data: scores,
                        backgroundColor: gradientColors,
                        borderColor: gradientColors.map(c => c.replace('0.85', '1').replace('0.7', '1')),
                        borderWidth: 2,
                        borderRadius: 8,
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `評価点: ${context.parsed.y}点`;
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 70,
                            ticks: { stepSize: 10 },
                            grid: { color: 'rgba(0, 0, 0, 0.05)' }
                        },
                        x: {
                            grid: { display: false },
                            ticks: { font: { size: window.innerWidth < 640 ? 9 : 11 } }
                        }
                    }
                }
            });
        }

        function renderRankingTable() {
            const tbody = document.getElementById('rankingTable');
            tbody.innerHTML = '';

            rankingData.forEach(horse => {
                const row = document.createElement('tr');
                row.className = 'hover:bg-green-50 transition';

                let bgClass = '';
                if (horse.rank === 1) bgClass = 'bg-red-50';
                else if (horse.rank === 2) bgClass = 'bg-orange-50';
                else if (horse.rank === 3) bgClass = 'bg-blue-50';

                let markClass = '';
                if (horse.mark === '◎') markClass = 'text-red-600 font-bold text-lg';
                else if (horse.mark === '○') markClass = 'text-orange-600 font-bold text-lg';
                else if (horse.mark === '▲') markClass = 'text-blue-600 font-bold text-lg';
                else if (horse.mark === '△') markClass = 'text-green-600 font-bold text-lg';
                else if (horse.mark === '×') markClass = 'text-gray-500 font-bold';

                let adjClass = horse.adjustment.startsWith('+') ? 'text-green-600' : (horse.adjustment.startsWith('-') ? 'text-red-600' : 'text-gray-500');

                row.innerHTML = `
                    <td class="p-3 font-bold ${bgClass}">${horse.rank}</td>
                    <td class="p-3 ${markClass} ${bgClass}">${horse.mark}</td>
                    <td class="p-3 font-bold text-green-800 ${bgClass}">${horse.number}番</td>
                    <td class="p-3 font-bold ${bgClass}">${horse.name}</td>
                    <td class="p-3 text-center text-gray-600 ${bgClass}">${horse.jockey}</td>
                    <td class="p-3 text-center ${bgClass}">${horse.baseScore}</td>
                    <td class="p-3 text-center font-bold ${adjClass} ${bgClass}">${horse.adjustment}</td>
                    <td class="p-3 text-center font-bold text-lg text-green-800 ${bgClass}">${horse.score}</td>
                    <td class="p-3 text-center ${bgClass}"><span class="px-2 py-1 rounded ${getConditionBadgeClass(horse.good)}">${horse.good}</span></td>
                    <td class="p-3 text-center ${bgClass}"><span class="px-2 py-1 rounded ${getConditionBadgeClass(horse.heavy)}">${horse.heavy}</span></td>
                `;
                tbody.appendChild(row);
            });
        }

        function getConditionBadgeClass(condition) {
            if (condition === '◎') return 'bg-red-500 text-white font-bold';
            if (condition === '○') return 'bg-green-500 text-white';
            if (condition === '▲') return 'bg-yellow-500 text-white';
            if (condition === '△') return 'bg-gray-400 text-white';
            return 'bg-gray-300 text-gray-700';
        }

        function renderHorseCards(filter = 'all') {
            const container = document.getElementById('horseCards');
            container.innerHTML = '';

            let filteredHorses = horses;
            if (filter === 'top') {
                filteredHorses = horses.filter(h => h.score >= 46);
            } else if (filter === 'ana') {
                filteredHorses = horses.filter(h => h.badge);
            }

            filteredHorses.sort((a, b) => b.score - a.score);

            filteredHorses.forEach(horse => {
                const card = createHorseCard(horse);
                container.appendChild(card);
            });
        }

        function createHorseCard(horse) {
            const card = document.createElement('div');
            card.className = 'horse-card glass-card p-6';

            let badgeHTML = '';
            if (horse.badge === 'honmei') badgeHTML = '<span class="badge-honmei text-white px-4 py-1 rounded-full text-sm font-bold"><i class="fas fa-star"></i> 本命</span>';
            else if (horse.badge === 'taikou') badgeHTML = '<span class="badge-taikou text-white px-4 py-1 rounded-full text-sm font-bold"><i class="fas fa-medal"></i> 対抗</span>';
            else if (horse.badge === 'ana') badgeHTML = '<span class="badge-ana text-white px-4 py-1 rounded-full text-sm font-bold"><i class="fas fa-gem"></i> 単穴</span>';
            else if (horse.badge === 'renka') badgeHTML = '<span class="badge-renka text-white px-4 py-1 rounded-full text-sm font-bold"><i class="fas fa-horse"></i> 連下</span>';
            else if (horse.badge === 'kiken') badgeHTML = '<span class="badge-kiken text-white px-4 py-1 rounded-full text-sm font-bold"><i class="fas fa-exclamation-triangle"></i> 危険</span>';

            let prosHTML = horse.details.pros.map(p => `<li class="flex items-start"><i class="fas fa-check-circle text-green-500 mr-2 mt-1"></i><span>${p}</span></li>`).join('');
            let consHTML = horse.details.cons.map(c => `<li class="flex items-start"><i class="fas fa-times-circle text-red-500 mr-2 mt-1"></i><span>${c}</span></li>`).join('');
            let expectHTML = horse.details.expect.map(e => `<li class="flex items-start"><i class="fas fa-star text-yellow-500 mr-2 mt-1"></i><span>${e}</span></li>`).join('');

            card.innerHTML = `
                <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-4">
                    <div class="flex items-center gap-3 mb-2 md:mb-0">
                        <div class="text-4xl font-bold text-green-800">${horse.number}</div>
                        <div>
                            <div class="text-2xl font-bold text-gray-800">${horse.name}</div>
                            <div class="text-sm text-gray-600">${horse.jockey} / ${horse.trainer}</div>
                        </div>
                    </div>
                    <div class="flex flex-col items-end gap-2">
                        ${badgeHTML}
                        <div class="text-3xl font-bold text-green-800">${horse.score}<span class="text-lg text-gray-500">点</span></div>
                    </div>
                </div>

                <div class="mb-4 p-4 bg-green-50 rounded-lg">
                    <div class="text-sm text-gray-700">
                        <div class="mb-2"><span class="font-bold">血統：</span>${horse.blood}</div>
                        <div class="flex gap-4">
                            <div><span class="font-bold">良馬場：</span><span class="px-2 py-1 rounded text-sm ${getConditionBadgeClass(horse.good)}">${horse.good}</span></div>
                            <div><span class="font-bold">稍重～：</span><span class="px-2 py-1 rounded text-sm ${getConditionBadgeClass(horse.heavy)}">${horse.heavy}</span></div>
                        </div>
                    </div>
                </div>

                <div class="mb-4" style="height: 280px; position: relative;">
                    <div class="font-bold text-gray-700 mb-2">12項目評価</div>
                    <canvas id="radarChart${horse.number}" style="height: 250px;"></canvas>
                </div>

                <div class="grid md:grid-cols-3 gap-4 text-sm">
                    ${prosHTML ? `<div><div class="font-bold text-green-600 mb-2 flex items-center"><i class="fas fa-thumbs-up mr-1"></i> 良い点</div><ul class="space-y-2">${prosHTML}</ul></div>` : ''}
                    ${consHTML ? `<div><div class="font-bold text-red-600 mb-2 flex items-center"><i class="fas fa-thumbs-down mr-1"></i> 不安材料</div><ul class="space-y-2">${consHTML}</ul></div>` : ''}
                    ${expectHTML ? `<div><div class="font-bold text-yellow-600 mb-2 flex items-center"><i class="fas fa-star mr-1"></i> 期待点</div><ul class="space-y-2">${expectHTML}</ul></div>` : ''}
                </div>
            `;

            setTimeout(() => { createRadarChart(horse); }, 100);
            return card;
        }

        function createRadarChart(horse) {
            const ctx = document.getElementById(`radarChart${horse.number}`);
            if (!ctx) return;

            new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: evaluationItems,
                    datasets: [{
                        label: '評価点',
                        data: horse.details.scores,
                        backgroundColor: 'rgba(22, 101, 52, 0.15)',
                        borderColor: 'rgba(22, 101, 52, 1)',
                        borderWidth: 2,
                        pointBackgroundColor: 'rgba(22, 101, 52, 1)',
                        pointBorderColor: '#fff',
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        r: {
                            beginAtZero: true,
                            max: 5,
                            ticks: { stepSize: 1, font: { size: 10 } },
                            pointLabels: { font: { size: window.innerWidth < 640 ? 9 : 11 } }
                        }
                    }
                }
            });
        }

        function filterHorses(filter) {
            renderHorseCards(filter);
        }
    </script>
</body>
</html>
